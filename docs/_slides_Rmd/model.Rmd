---
---

## Smooth lines

The `geom_smooth` layer adds a regression line with confidence intervals (95% CI by default). The `method = 'lm'` parameter specifies that a linear model is used for smoothing.

===

Prepare some data in dplyr as for a linear model with a categorical predictor.

```{r, title = '{{ site.handouts }}'}
levels(animals$sex) <- c('Female', 'Male')
animals_dm <- filter(animals, species_id == 'DM')
```

===

```{r plot_lm, title = '{{ site.handouts }}'}
ggplot(animals_dm,
  aes(x = year, y = weight, shape = sex)) + 
  geom_point(size = 3, stat = 'summary', fun.y = 'mean') +
  geom_smooth(method = 'lm')
```

===

Even better would be to distinguish everything (points and lines) by color:

```{r plot_lm_color, title='{{ site.handouts }}'}
ggplot(animals_dm,
  aes(x = year, y = weight,
    shape = sex, color = sex)) + 
  geom_point(size = 3, stat = 'summary', fun.y = 'mean') +
  geom_smooth(method = 'lm')
```

Notice that by adding aesthetic mappings in the base aesthetic (in the `ggplot` command), it is applied to any layer that recognizes the parameter.
